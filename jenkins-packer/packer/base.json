{
    "variables": {
       "service_account_key_file": "{{env `YC_ACCOUNT_KEY_FILE`}}",
       "folder_id": "{{env `YC_FOLDER_ID`}}",
       "subnet_id": "{{env `YC_SUBNET_ID`}}"
    },
    "builders": [
      {
        "type":      "yandex",
        "service_account_key_file" :  "{{user `service_account_key_file`}}",
        "folder_id": "{{user `folder_id`}}",
        "subnet_id": "{{user `subnet_id`}}",
        "zone":      "ru-central1-b",
  
        "image_name":   "debian-9-nginx-{{isotime | clean_resource_name}}",
        "image_family": "debian-web-server",
        "image_description": "Yet another debian build 2",
  
        "source_image_family": "debian-9",
        "disk_type":           "network-nvme",
        "ssh_username":        "debian",
  
        "use_ipv4_nat": true
      }
    ],
    "provisioners": [
      {
          "type": "shell",
          "inline": [
            "echo 'updating APT'",
            "sudo apt-get update -y",
            "sudo apt-get install -y nginx",
            "sudo su -",
            "sudo systemctl enable nginx.service",
            "curl localhost"
          ]
      }
    ]
  }
